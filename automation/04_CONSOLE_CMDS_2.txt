# Console Commands for Step 2 (Coding)
# Do not use echo
# Only edit the section between CODE START and CODE END - always run scripts using python, e.g. /run python scripts/myscript.py

### CODE START ###

# Final migration validation
/run alembic history --verbose
/run alembic current --verbose
/run alembic upgrade head --sql > migrations/latest_prod.sql

# Final verification checks
/run python scripts/verification/verify_db_schema.py --full --validate-relations --fix-missing-columns
/run python scripts/verification/verify_production_ready.py --check-migrations --skip-limiter-check

# Commit verified state
/run python scripts/commit_changes.py --message "Database schema finalized - confirmed_at column verified"

### CODE END ###

# Console commands done, we go on to 05_STEP_3.txt
/load automation/05_STEP_3.txt
