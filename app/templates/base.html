<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Stipend Management System</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">
    <link href="https://cdn.jsdelivr.net/npm/tailwindcss@2.2.19/dist/tailwind.min.css" rel="stylesheet">
</head>
<body class="bg-gray-800 text-white dark:bg-gray-900 dark:text-gray-300 dark">
<header class="bg-gray-700 shadow-md dark:bg-gray-800">
    <nav class="container mx-auto p-4 flex justify-between items-center">
        <ul class="flex space-x-4">
            <li><a href="{{ url_for('public.index') }}" class="text-blue-500 hover:underline">Home</a></li>
            {% if current_user.is_authenticated %}
                {% if current_user.is_admin %}
                    <li><a href="{{ url_for('admin.dashboard.dashboard') }}" class="text-blue-500 hover:underline">Dashboard</a></li>
                    <li><a href="{{ url_for('admin.organization.index') }}" class="text-blue-500 hover:underline">Organizations</a></li>
                    <li><a href="{{ url_for('admin.stipend.index') }}" class="text-blue-500 hover:underline">Stipends</a></li>
                    <li><a href="{{ url_for('admin.tag.index') }}" class="text-blue-500 hover:underline">Tags</a></li>
                    <li><a href="{{ url_for('admin.user.index') }}" class="text-blue-500 hover:underline">Users</a></li>
                {% else %}
                    <li><a href="{{ url_for('user.profile') }}" class="text-blue-500 hover:underline">Profile</a></li>
                {% endif %}
                <li><a href="{{ url_for('public.logout') }}" class="text-red-500 hover:underline">Logout</a></li>
            {% else %}
                <li><a href="{{ url_for('user.login') }}" class="text-blue-500 hover:underline">Login</a></li>
                <li><a href="{{ url_for('public.register') }}" class="text-green-500 hover:underline">Register</a></li>
            {% endif %}
        </ul>
        <button id="theme-toggle" class="bg-gray-200 p-2 rounded-md dark:bg-gray-700 dark:text-white">Toggle Theme</button>
    </nav>
</header>
<div class="flashes mb-4">
    {% with messages = get_flashed_messages(with_categories=true) %}
      {% if messages %}
        {% for category, message in messages %}
          <div class="{{ category }} p-2 mb-2 rounded dark:bg-gray-800 dark:text-red-500">
              {% if category == 'success' %}
                  <div class="bg-green-100 border border-green-400 text-green-700 px-4 py-3 rounded dark:bg-green-900 dark:border-green-800 dark:text-green-200">
                      {{ message }}
                  </div>
              {% elif category == 'error' %}
                  <div class="bg-red-100 border border-red-400 text-red-700 px-4 py-3 rounded dark:bg-red-900 dark:border-red-800 dark:text-red-200">
                      {{ message }}
                  </div>
              {% elif category == 'info' %}
                  <div class="bg-blue-100 border border-blue-400 text-blue-700 px-4 py-3 rounded dark:bg-blue-900 dark:border-blue-800 dark:text-blue-200">
                      {{ message }}
                  </div>
              {% elif category == 'warning' %}
                  <div class="bg-yellow-100 border border-yellow-400 text-yellow-700 px-4 py-3 rounded dark:bg-yellow-900 dark:border-yellow-800 dark:text-yellow-200">
                      {{ message }}
                  </div>
              {% else %}
                  <div class="bg-gray-100 border border-gray-400 text-gray-700 px-4 py-3 rounded dark:bg-gray-900 dark:border-gray-800 dark:text-gray-200">
                      {{ message }}
                  </div>
              {% endif %}
          </div>
        {% endfor %}
      {% endif %}
    {% endwith %}
</div>
<div id="htmx-indicator" style="display: none;">
    <p>Loading...</p>
</div>
<script>
    document.body.addEventListener('htmx:configRequest', () => {
        document.getElementById('htmx-indicator').style.display = 'block';
    });
    document.body.addEventListener('htmx:afterRequest', () => {
        document.getElementById('htmx-indicator').style.display = 'none';
    });

    document.getElementById('menu-toggle').addEventListener('click', function () {
        const menu = document.getElementById('nav-menu');
        menu.classList.toggle('hidden');
    });

    // Theme toggle functionality
    const toggleButton = document.getElementById('theme-toggle');
    const currentTheme = localStorage.getItem('theme') || 'dark';
    document.body.classList.add(currentTheme);

    toggleButton.addEventListener('click', function () {
        if (document.body.classList.contains('dark')) {
            document.body.classList.remove('dark');
            localStorage.setItem('theme', '');
        } else {
            document.body.classList.add('dark');
            localStorage.setItem('theme', 'dark');
        }
    });
</script>
{% block content %}{% endblock %}
</main>
<footer class="bg-gray-700 shadow-md text-center p-4 mt-8 dark:bg-gray-800">
    <p>&copy; Me.</p>
</footer>
<script src="{{ url_for('static', filename='js/main.js') }}"></script>
</body>
</html>
